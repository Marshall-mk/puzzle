<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle Game</title>
    <link rel="stylesheet" href="static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>

    <header id="app-header">
        <div class="header-content">
            <img src="static/images/logos/logo-left.png" alt="Logo" class="header-logo">
            <div class="header-text">
                <h1>Puzzle Game</h1>
                <p>Challenge your brain and learn about health!</p>
            </div>
            <img src="static/images/logos/logo-right.png" alt="Logo" class="header-logo">
        </div>
    </header>

    <div id="timer-container">
        Time: <span id="timer">00:00</span>
    </div>

    <div id="countdown-overlay">3</div>

    <main>
        <!-- Player Entry -->
        <section id="player-id-area" class="glass-panel">
            <h2>Welcome!</h2>
            <p style="color:#666; margin-bottom:20px;">Enter your name to begin.</p>
            <input type="text" id="player-id" placeholder="Your Name" required
                style="width: 80%; padding: 10px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ccc;">
            <p id="error-message" class="error-msg hidden"></p>
            <button onclick="startGame()" class="btn-primary">Start Game</button>
        </section>

        <!-- Sidebar -->
        <aside id="sidebar" class="glass-panel hidden">
            <h3 style="padding: 20px; border-bottom: 1px solid rgba(0,0,0,0.05); margin: 0;">Learning Hub</h3>
            <div id="modality-menu">
                <!-- Dropdowns will be injected here -->
                <div class="modality-menu">
                    <button class="modality-toggle" onclick="toggleModality('mri')">MRI <span>â–¼</span></button>
                    <div id="mri-content" class="modality-content">
                        Magnetic Resonance Imaging (MRI) uses strong magnetic fields and radio waves to generate images
                        of the organs in the body. It does not use ionizing radiation.
                    </div>
                </div>
                <div class="modality-menu">
                    <button class="modality-toggle" onclick="toggleModality('ct')">CT Scan <span>â–¼</span></button>
                    <div id="ct-content" class="modality-content">
                        Computed Tomography (CT) combines a series of X-ray images taken from different angles around
                        your body and uses computer processing to create cross-sectional images (slices).
                    </div>
                </div>
                <div class="modality-menu">
                    <button class="modality-toggle" onclick="toggleModality('xray')">X-Ray <span>â–¼</span></button>
                    <div id="xray-content" class="modality-content">
                        X-rays are a form of electromagnetic radiation. They create images of the inside of your body.
                        The images show the parts of your body in different shades of black and white.
                    </div>
                </div>
                <div class="modality-menu">
                    <button class="modality-toggle" onclick="toggleModality('ultrasound')">Ultrasound
                        <span>â–¼</span></button>
                    <div id="ultrasound-content" class="modality-content">
                        Ultrasound imaging uses high-frequency sound waves to view inside the body. Because ultrasound
                        images are captured in real-time, they can show the structure and movement of the body's
                        internal organs.
                    </div>
                </div>
            </div>

            <div style="padding: 20px; margin-top: auto;">
                <button onclick="goHome()" class="btn-secondary" style="width: 100%; margin-bottom: 10px;">Home</button>
                <button onclick="restartLevel()" class="btn-secondary" style="width: 100%;">Restart Level</button>
            </div>
        </aside>

        <!-- Game Area (Split View) -->
        <section id="game-split-view" class="hidden">
            <!-- Left: Puzzle -->
            <div id="puzzle-panel" class="glass-panel">
                <img id="puzzle-image" src="" alt="Puzzle" style="display:none;">
                <p id="metadata"></p>
                <div style="margin-top: 20px;">
                    <!-- Validate button was requested, but user also wants questions "jointly". 
                          Usually validation enables questions, but user wants them side by side.
                          I'll keep validation to "lock in" the puzzle, but show questions immediately?
                          Or maybe validation is just to check if puzzle is done. 
                          I will keep validation check. -->
                    <button id="validate-button" onclick="validatePuzzle()" class="btn-primary hidden">
                        Validate Puzzle
                    </button>
                </div>
            </div>

            <!-- Right: Quiz -->
            <div id="quiz-panel" class="glass-panel hidden">
                <h3>Quiz</h3>
                <div id="questions-container">
                    <p style="color: #777;">Loading questions...</p>
                </div>
                <button id="submit-quiz-btn" onclick="submitAnswers()" class="btn-primary"
                    style="margin-top: 20px; width: 100%;">Submit Answers</button>
                <div id="quiz-feedback" class="hidden" style="margin-top: 20px;"></div>
            </div>
        </section>

        <!-- Results (Overlay or replace main content? For split view, replace main content area or show modal) -->
        <section id="result-container" class="glass-panel hidden"
            style="margin: auto; max-width: 600px; padding: 40px; text-align: center;">
            <!-- Dynamic content -->
        </section>
    </main>

    <!-- Modals -->
    <div id="success-modal" class="modal hidden">
        <div class="modal-content">
            <h2 style="color: #2e7d32;">ðŸŽ‰ Puzzle Solved!</h2>
            <p>Great job! Now finish the quiz if you haven't already.</p>
            <button onclick="closeModal('success-modal')" class="btn-primary"
                style="margin-top: 20px;">Continue</button>
        </div>
    </div>

    <div id="try-again-modal" class="modal hidden">
        <div class="modal-content">
            <h2 style="color: #f57c00;">Not quite...</h2>
            <p>Keep trying!</p>
            <button onclick="closeModal('try-again-modal')" class="btn-primary" style="margin-top:20px;">OK</button>
        </div>
    </div>

    <div id="timeout-modal" class="modal hidden">
        <div class="modal-content">
            <h2 style="color: #c0392b;">Time's Up!</h2>
            <p>You ran out of time.</p>
            <button onclick="restartLevel()" class="btn-primary" style="margin-top: 20px;">Restart Level</button>
        </div>
    </div>

    <!-- No footer needed for full screen app, simplified -->

    <script src="static/script.js"></script>
</body>

</html>